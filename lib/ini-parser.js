const ini=require("ini"),path=require("path"),fs=require("fs"),util=require("util"),read_file=util.promisify(fs.readFile);function readDefaults(default_config_path){var defaults_path=path.join(process.env.APPDIR,"config","defaults"),default_config_path=path.join(defaults_path,default_config_path);return read_file(default_config_path,"utf8").then(txt=>{return ini.decode(txt)})}function readUserConfig(user_ini_path){user_ini_path=path.join(process.env.APPDIR,"config",user_ini_path);return read_file(user_ini_path,"utf8").then(txt=>ini.decode(txt)).catch(e=>!1)}module.exports=(ini_file,opts)=>((opts=opts||{}).merge="boolean"!=typeof opts.merge||opts.merge,readDefaults(ini_file).then(default_config=>readUserConfig(ini_file).then(user_config=>{return opts.merge&&user_config?Object.assign(default_config,user_config):user_config||default_config})));