define(["knockout","rootVM","wifiRates","http","app/observables/receipt","text!app/components/wallet-prompt/wallet-prompt.html","/public/plugins/charging-station/assets/scripts/ko/utils/format-time.js","app/utils/formatBytes","toast","app/components/seconds-format/SecondsFormat"],function(ko,rootVM,wifiRates,http,receipt,tpl,formatTime,formatBytes,toast){ko.components.register("charging-wallet-prompt",{viewModel:function(params){var self=this;self.charging_port_id=params.charging_port_id,self.customer=params.customer,self.close=params.close,self.amount=ko.observable(""),self.currency=wifiRates.currency(),self.payNow=function(){var opts=self.amount();0<opts&&opts<=self.customer.credits()&&(opts={amount:opts,charging_port_id:self.charging_port_id},http.post("/charging-plugin/wallet-payment",opts,function(charging_port,ft){if(charging_port)return toast.error(charging_port.responseText);charging_port=ft.charging_port,ft=(ft=formatTime(ft.time_seconds)).hh+":"+ft.mm+":"+ft.ss;self.close(),toast.success(ft+" time credits added to charging port "+charging_port.alias),rootVM.navigate("buy-charging")}))},self.koDescendantsComplete=function(){document.getElementById("wallet-amount").focus()}},template:tpl})});